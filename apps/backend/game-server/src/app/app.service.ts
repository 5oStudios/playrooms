import { Inject, Injectable } from '@nestjs/common';
import { KEYCLOAK_INSTANCE } from 'nest-keycloak-connect';
import KeycloakConnect from 'keycloak-connect';

@Injectable()
export class AppService {

  constructor(
    @Inject(KEYCLOAK_INSTANCE) private readonly keycloak: KeycloakConnect.Keycloak,

  ) {
  }
  async getData() {
    console.log('Authenticating user ', await this.keycloak.grantManager.userInfo('eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ0cXFBelVpZ24zMDRDUTdITDl4UTc2aGZlSHRJd09iX1Y5dHkwOTlrU0JzIn0.eyJleHAiOjE3MjE1NzA0NzksImlhdCI6MTcyMTU3MDE3OSwiYXV0aF90aW1lIjoxNzIxNTY3Nzk3LCJqdGkiOiI4NGY5NmNkMC0xM2RkLTRlNWItODYwYS1hZWU4ZWMxYmQ0ZjciLCJpc3MiOiJodHRwczovL2F1dGguNW9zdHVkaW9zLmNvbS9yZWFsbXMva2luZ28iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiODA3ZTRjZGMtMzJkNi00YjNlLThhNWMtZTE2Njk0MGU3MTkxIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYWNjb3VudC1jb25zb2xlIiwibm9uY2UiOiI5OWYwZDQ2MC00ZTAzLTQ4YzYtOGU1ZS1lMGE5NWY5NjIxMGQiLCJzZXNzaW9uX3N0YXRlIjoiNmY0NWJjMDEtYWNmZS00MzVhLThmMGUtYTc3MzEzY2FmYjJlIiwiYWNyIjoiMCIsInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiXX19LCJzY29wZSI6Im9wZW5pZCBlbWFpbCBwcm9maWxlIiwic2lkIjoiNmY0NWJjMDEtYWNmZS00MzVhLThmMGUtYTc3MzEzY2FmYjJlIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiQWJkZWxyYWhtYW4gRXNzYXd5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWJkZWxyYWhtYW4ubW8uZXNzYXd5QGdtYWlsLmNvbSIsImdpdmVuX25hbWUiOiJBYmRlbHJhaG1hbiIsImZhbWlseV9uYW1lIjoiRXNzYXd5IiwiZW1haWwiOiJhYmRlbHJhaG1hbi5tby5lc3Nhd3lAZ21haWwuY29tIn0.0U3b7JJ4Bcq6XfIzHhXbZS11CWPsRneEAbZH2c2twzbYsG4g1f6v1sAOM_DvcwHJWAFbJGRRPl9NXVegVtdfI-edgg4u6U_xe-Xwjm9CNA30RgWJQnqz6au_tVdza4rpc2iNI1RCiyrltBKR1UWFhq6Rw2s2VOd-PmYN0ErrmcNJWSiVQuLn4GybMEc6vZ3QBW55nht3jyRCvjDbaE200afShZZ5qeXjUWAYTNVC4tx88T9v8ayUxLmc-AYGbmHmZnj8gX9f4MoYR2t7y_-fTUI2ZTUce_fNpzE1smIKV7zKXUMCSMkhVeroStltiT9mi8WprS_IlKZhUl8qsxCakw'));
    return ({ message: 'Hello API' });
  }
}
